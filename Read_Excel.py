import streamlit as st
import pandas as pd

# ุฅุนุฏุงุฏุงุช ุงูุตูุญุฉ
st.set_page_config(page_title="ูุชุงุฆุฌ ุงููุงุนุจูู", layout="centered")

# ุชุตููู ุงูุซูู (CSS ุจุณูุท ูุฌุนู ุงููููุน ุฏุงููุงู ูุฌุฐุงุจุงู)
st.markdown("""
    <style>
    .main { background-color: #0e1117; color: white; }
    .stDataFrame { border: 2px solid #4B0082; border-radius: 10px; }
    h1 { color: #00e5ff; text-align: center; font-family: 'Arial'; }
    </style>
    """, unsafe_allow_html=True)

st.title("๐ ููุญุฉ ูุชุตุฏุฑูู ุงููุนุจุฉ")

# ุงุณู ููู ุงูุฅูุณู ูุงุณู ุงููุฑูุฉ ุงูููุงุฆูุฉ (ูู ุจุชุบููุฑ 'Results' ูุงุณู ูุฑูุชู ุงูููุงุฆูุฉ)
file_name = 'Results.xlsx'
sheet_target = 'ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ' # ุถุน ููุง ุงุณู ุงููุฑูุฉ ุงูุชู ุชุญุชูู ุนูู ุงููุชุงุฆุฌ

try:
    # 1. ูุฑุงุกุฉ ุงููุฑูุฉ ุงููุญุฏุฏุฉ ููุท ูู ููู ุงูุฅูุณู
    df = pd.read_excel(file_name, sheet_name=sheet_target)

    # 2. ุชูุธูู ุงูุจูุงูุงุช: ุญุฐู ุงูุตููู ุงููุงุฑุบุฉ ุชูุงูุงู
    df = df.dropna(how='all')

    # 3. ุญุฐู ุงูุตููู ุงูุชู ุชุญุชูู ุนูู ุฎุงูุงุช ูุงุฑุบุฉ ูู ุฃุนูุฏุฉ ุฃุณุงุณูุฉ (ูุซู ุงูุนููุฏ ุงูุฃูู ูุงูุซุงูู)
    # ูุฐุง ุณูุฎูู ุงูุตููู ุงูุชู ุชุญุชูู ุนูู ูุนุงุฏูุงุช ููู ุจุฏูู ูุชุงุฆุฌ ุญููููุฉ
    df = df.dropna(subset=[df.columns[0], df.columns[1]])

    # 4. ุชุฑุชูุจ ุงูุจูุงูุงุช ุญุณุจ ุงูููุงุท (ุจุงูุชุฑุงุถ ุงูุนููุฏ ุงูุซุงูู ูู ุงูููุงุท)
    df = df.sort_values(by=df.columns[1], ascending=False)

    # ุนุฑุถ ุงูุฌุฏูู ุจุดูู ุฃููู
    st.write(f"### ูุงุฆูุฉ ุงููุชุตุฏุฑูู (ุชุญุฏูุซ ูุจุงุดุฑ)")
    
    # ุชูุณูู ุงูุฌุฏูู ููุธูุฑ ุจุดูู ุงุญุชุฑุงูู ุจุฏูู ุฃุฑูุงู ุงููุคุดุฑ ุงูุฌุงูุจูุฉ
    st.table(df) 

except Exception as e:
    st.error(f"ุญุฏุซ ุฎุทุฃ: ุชุฃูุฏ ูู ุงุณู ููู ุงูุฅูุณู ูุงุณู ุงููุฑูุฉ (Sheet Name). ุงูุฎุทุฃ: {e}")